INSERT OVERWRITE DIRECTORY 'gs://bda5-keepcoding-ricardo1/output/recommendation' ROW FORMAT DELIMITED FIELDS TERMINATED BY ';' select airbnb.Listing_Url, yelp.name, 2 * 6371000 * asin(sqrt(pow(sin(radians((cast(split(airbnb.geolocation,',')[0] as decimal(20,10)) - yelp.lat) / 2)),2) 
+ cos(radians(yelp.lat)) * cos(radians(cast(split(airbnb.geolocation,',')[0] as decimal(20,10)))) * pow(sin(radians((cast(split(airbnb.geolocation,',')[1] as decimal(20,10)) - yelp.lon) / 2)), 2))) as distance from airbnb left join yelp on airbnb.City = yelp.city where airbnb.geolocation is not null and yelp.photos > 1000 order by distance asc limit 10;
